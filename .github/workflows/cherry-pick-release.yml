name: Cherry-Pick into Release Branch

on:
  push:
    branches: ["auto-pick"]

jobs:
  release_pull_requestk:
    name: release_pull_request
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v1

      - name: Check PR labels action step
        id: check_pr_labels
        uses: shioyang/check-pr-labels-on-push-action@v1.0.6
        with:
          github-token: ${{ secrets.GH_PERSONAL_ACCESS_TOKEN }}
          labels: '["release-*"]'

      - name: print result
        run: |
          echo "RESULT: ${{ steps.check_pr_labels.outputs.result }}"

      - name: Create PR into release branch
        if: steps.check_pr_labels.outputs.result
        uses: gorillio/github-action-cherry-pick@master
        with:
          pr_branch: ${{ steps.check_pr_labels.outputs.result }}
        env:
          GITHUB_TOKEN: ${{ secrets.GH_PERSONAL_ACCESS_TOKEN }}
          DRY_RUN: true
